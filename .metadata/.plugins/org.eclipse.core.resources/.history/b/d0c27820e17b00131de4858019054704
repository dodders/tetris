package com.gd.tetris;

import com.gd.tetris.model.Model;

import javafx.application.Platform;
import javafx.scene.Node;
import javafx.scene.layout.GridPane;
import javafx.scene.paint.Color;
import javafx.scene.shape.Rectangle;

public class Controller implements Runnable {

	//TilePane view;
	GridPane view;
	Model model;
	Rectangle r;
	Rectangle prev;
	int rows;
	int cols;
	
	public Controller(GridPane tp, Model model) {
		this.view = tp;
		this.model = model;
		setView();
		this.rows = model.rows;
		this.cols = model.cols;
	}
	
	private void setView() {
		for (int r = 0; r < rows; r++) {
			for (int c = 0; c < cols; c++) {
				Rectangle rect = new Rectangle(20,20,20,20);
				rect.setFill(Color.AQUA);
				gridView.add(rect, c, r);
			}
		}
		
	}

	@Override
	public void run() {
		for (Node n : view.getChildren()) {
			prev = r;
			r = (Rectangle)n;
			Platform.runLater(new Runnable() {
				@Override
				public void run() {
					if (prev != null) {
						prev.setFill(Color.AQUA);
					}
					r.setFill(Color.GREEN);
				}
			});
			try {
				Thread.sleep(100);
			} catch (InterruptedException e) {
				System.exit(1);
			}
		}
	}

}
